<%- include('../partials/head.ejs') %>
    <body>
        <%- include('../partials/navbar.ejs') %>
        <main class="bg-gray-50 min-h-screen pt-4 pb-12">
            <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
                <!-- Breadcrumb -->
                <div class="flex items-center justify-between mb-6">
                    <nav class="flex text-sm text-gray-500">
                        <a href="/" class="hover:text-emerald-600 transition-colors">Home</a>
                        <span class="mx-2">/</span>
                        <a href="/laptops" class="hover:text-emerald-600 transition-colors">Laptops</a>
                        <span class="mx-2">/</span>
                        <span class="text-gray-900 font-bold"><%= brandName %></span>
                    </nav>
                </div>

                <!-- Title -->
                <div class="mb-8">
                    <h1 class="text-2xl font-bold text-gray-900"><%= brandName %> Laptops</h1>
                    <p class="text-sm text-gray-500 mt-1">Showing all available <%= brandName %> laptops</p>
                </div>

                <!-- Product Grid (Full Width) -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    <% if (laptops && laptops.length > 0) { %>
                        <% laptops.forEach(laptop => { 
                            const discount = laptop.mrp - laptop.price;
                            const discountPercent = Math.round((discount / laptop.mrp) * 100);
                        %>
                        <a href="/laptop/<%= laptop._id %>" class="product-card bg-white border border-gray-200 rounded-lg p-3 hover:shadow-lg transition-all duration-300 flex flex-col relative group h-full">
                            
                            <!-- Header Badges -->
                            <div class="flex justify-between items-start w-full relative z-10 mb-2">
                                <div class="bg-gray-900 text-white text-[10px] font-bold px-2 py-0.5 rounded flex items-center gap-1">
                                    <i class="fas fa-check-circle text-emerald-400 text-[10px]"></i>
                                    <span>SIMTECH ASSURED</span>
                                </div>
                                <% if(laptop.stockQuantity < 5 && laptop.stockQuantity > 0) { %>
                                <div class="border border-red-500 text-red-500 text-[10px] font-bold px-2 py-0.5 rounded">
                                    <%= laptop.stockQuantity %> left
                                </div>
                                <% } %>
                            </div>

                            <!-- Image -->
                            <div class="relative w-full h-48 mb-3 flex items-center justify-center bg-gray-50 rounded-lg p-4 overflow-hidden">
                                <% if (laptop.stockQuantity === 0) { %>
                                    <div class="absolute top-3 left-1/2 -translate-x-1/2 bg-red-600/95 text-white text-sm font-bold px-4 py-1 rounded-md shadow-md -skew-x-6 transform pointer-events-none">
                                        Out of Stock
                                    </div>
                                <% } %>
                                <img src="<%= laptop.imageUrls[0] %>" alt="<%= laptop.brand %> <%= laptop.model %>" class="max-h-full max-w-full object-contain mix-blend-multiply transition-transform duration-300 group-hover:scale-105">
                            </div>

                            <!-- Discount Tag -->
                            <div class="mb-2">
                                <span class="bg-green-50 text-emerald-600 text-[10px] font-bold px-1.5 py-0.5 rounded">₹<%= discount.toLocaleString('en-IN') %> OFF</span>
                            </div>

                            <!-- Title -->
                            <h3 class="font-bold text-gray-900 text-sm leading-tight mb-2 line-clamp-2 min-h-[40px]">
                                <%= laptop.brand %> <%= laptop.model %> (<%= laptop.specifications.processor %>)
                            </h3>

                            <!-- Specs -->
                            <div class="flex flex-wrap gap-2 mb-3">
                                <% if(laptop.specifications.processor) { %>
                                <span class="bg-gray-100 text-gray-600 text-[10px] font-medium px-2 py-1 rounded"><%= laptop.specifications.processor %></span>
                                <% } %>
                                <% if(laptop.specifications.ram) { %>
                                <span class="bg-gray-100 text-gray-600 text-[10px] font-medium px-2 py-1 rounded"><%= laptop.specifications.ram %></span>
                                <% } %>
                                <% if(laptop.specifications.storage) { %>
                                <span class="bg-gray-100 text-gray-600 text-[10px] font-medium px-2 py-1 rounded"><%= laptop.specifications.storage %></span>
                                <% } %>
                            </div>

                            <!-- Rating Section -->
                            <div class="flex items-center gap-2 mb-3">
                                <span class="bg-blue-900 text-white text-[10px] font-bold px-2 py-0.5 rounded">Certified</span>
                                <div class="border border-gray-200 px-1 py-0.5 rounded flex items-center gap-1">
                                    <span class="text-xs font-bold text-gray-700">5.0</span>
                                    <i class="fas fa-star text-yellow-400 text-[10px]"></i>
                                </div>
                            </div>

                            <!-- Price Section -->
                            <div class="flex items-center gap-2">
                                <span class="text-red-500 text-sm font-medium">-<%= discountPercent %>%</span>
                                <span class="text-lg font-bold text-gray-900">₹<%= laptop.price.toLocaleString('en-IN') %></span>
                                <span class="text-xs text-gray-400 line-through text-decoration-line-through decoration-gray-400">₹<%= laptop.mrp.toLocaleString('en-IN') %></span>
                            </div>
                        </a>
                        <% }) %>
                    <% } else { %>
                        <div class="col-span-full text-center py-24">
                            <div class="flex flex-col items-center justify-center">
                                <div class="h-16 w-16 bg-gray-100 rounded-full flex items-center justify-center mb-4">
                                    <i class="fas fa-laptop text-gray-400 text-2xl"></i>
                                </div>
                                <h3 class="text-lg font-bold text-gray-900">No laptops found</h3>
                                <p class="text-gray-500 mt-1">We couldn't find any <%= brandName %> laptops in stock mostly.</p>
                                <a href="/laptops" class="mt-4 text-emerald-600 font-bold hover:underline">View all laptops</a>
                            </div>
                        </div>
                    <% } %>
                </div>
            </div>
        </main>
        <%- include('../partials/footer.ejs') %>
    </body>
